import keras
from tensorflow.python.ops.numpy_ops import np_config

INPUT_PATH = '../data/images'
np_config.enable_numpy_behavior()

"""
Returns a tf.data.Dataset object with tuple (images, labels) where:
Images have shape (BATCH_SIZE, 256, 512, 3),
Labels are an int32 tensor of shape (batch_size,)
"""
dataset = keras.utils.image_dataset_from_directory(
    INPUT_PATH,
    subset="training",
    labels="inferred",
    label_mode="int",
    batch_size=None,
    validation_split=0.1,

    color_mode="rgb",
    image_size=(256, 512),

    shuffle=True,
    seed=15,
)

dataset = dataset.map(
    lambda x, y: (
        x.astype('float32') - 127.5 / 127.5, 
        y
    )
)

print("Training set created.")
print()